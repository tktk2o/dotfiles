# reduce tmux delay for more responsiveness
set -sg escape-time 1

# window and pane index count starts in 1
set -g base-index 1
setw -g pane-base-index 1

# ウィンドウ名の自動更新を無効にする
set-option -g allow-rename off

bind r source-file ~/.tmux.conf \; display "Reloaded."

# enable mouse mode
set -g mouse on
set -g set-titles on

##############################
#
# key-bind
#
##############################

# prefix key (default: C-b)
set -g prefix C-b
bind C-b send-prefix
# bind split vertically from % to |
bind | split-window -h

bind - split-window -v

# smart-splits.nvim: Neovim/tmux間のシームレスなペイン移動
is_vim="ps -o state= -o comm= -t '#{pane_tty}' | grep -iqE '^[^TXZ ]+ +(\\S+\\/)?g?\.?(view|n?vim?x?)(diff)?$'"
bind-key -n C-h if-shell "$is_vim" 'send-keys C-h' 'select-pane -L'
bind-key -n C-j if-shell "$is_vim" 'send-keys C-j' 'select-pane -D'
bind-key -n C-k if-shell "$is_vim" 'send-keys C-k' 'select-pane -U'
bind-key -n C-l if-shell "$is_vim" 'send-keys C-l' 'select-pane -R'

# prefix付きペイン移動（従来通り）
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R
bind -r C-h select-window -t :-
bind -r C-l select-window -t :+

# pane resizing
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

##############################
#
# set color(dracula-theme)
#
##############################
BACK_GROUND="#282a36"
SELECTION="#44475a"
FORE_GROUND="#f8f8f2"
COMMENT="#6272a4"
CYAN="#8be9fd"
GREEN="#50fa7b"
ORANGE="#ffb86c"
PINK="#ff79c6"
PURPLE="#bd93f9"
RED="#ff5555"
YELLOW="#f1fa8c"
##############################

# set the default terminal mode to 256color mode
set -g default-terminal "screen-256color"
set -g terminal-overrides 'xterm:colors=256'

# status bar - ultra minimal
set -g status-position bottom
set -g status-style "bg=$SELECTION,fg=$FORE_GROUND"
set -g status-justify centre

# left: session name
set -g status-left-length 20
set -g status-left "#[fg=$BACK_GROUND,bg=$PURPLE,bold] #S #[default]"

# right: date/time
set -g status-right-length 30
set -g status-right "#[fg=$BACK_GROUND,bg=$PURPLE] %Y-%m-%d(%a) %H:%M:%S "

# window list
set -g window-status-separator "  "
set -g window-status-current-format "#[fg=$BACK_GROUND,bg=$PURPLE] #I:#W "
set -g window-status-format "#[fg=$COMMENT] #I:#W "

set -g status-interval 1

# pane border color
set -g pane-border-style fg=$SELECTION
set -g pane-active-border-style fg=$COMMENT

# command / message line
set -g message-style bg=$SELECTION,fg=$PINK

# enable visual notification
setw -g monitor-activity on
set -g visual-activity on

# copy mode
## enable vi keys.
set-window-option -g mode-keys vi
## set copy mode bind v
bind-key v copy-mode \; display "Copy mode!"
## copy y / Enter
bind-key -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "pbcopy"
bind-key -T copy-mode-vi Enter send-keys -X copy-pipe-and-cancel "pbcopy"
